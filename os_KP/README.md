# Игра "Быки и коровы"

Многопользовательская игра с использованием именованных pipe'ов для связи между сервером и клиентами.

## Как играть

Сервер загадывает слово из словаря, игроки пытаются его угадать. После каждой попытки показывается:
- **Быки** - буквы на правильных позициях
- **Коровы** - правильные буквы на неправильных позициях

## Сборка

```bash
make
```

Или вручную:
```bash
gcc -Wall -Wextra -std=c11 -Iinclude -o server src/server.c src/game_logic.c
gcc -Wall -Wextra -std=c11 -Iinclude -o client src/client.c
```

Очистка:
```bash
make clean      # Удаление скомпилированных файлов
make distclean  # Полная очистка (включая pipe'ы и логи)
```

## Запуск

Сервер:
```bash
./server [количество_игроков]
```

По умолчанию 4 игрока, максимум 4.

Клиент:
```bash
./client [player_id] [player_name]
```

Если не указать ID, используется PID процесса. Если не указать имя, программа спросит.

## Пример

Терминал 1 (Сервер):
```bash
$ ./server 2
Сервер инициализирован
Сервер запущен. Ожидание 2 игроков...
Ожидание подключения игроков (0/2)...
Игрок Иван (ID: 1234) присоединился. Игроков: 1/2
Игрок Петр (ID: 5678) присоединился. Игроков: 2/2
Игра началась!
Игрок Иван: apple -> Быки: 2, Коровы: 1
Игрок Иван выиграл! Слово: apple
```

Терминал 2 (Клиент 1):
```bash
$ ./client 1234 Иван
Подключено к серверу
> Вы подключены! Ожидаем других игроков (1/2)
> Все игроки подключены! Игра началась. Слово состоит из 5 букв.
Введите предположение: apple
> Ваш результат: Быки: 5, Коровы: 0
=== ПОБЕДА! Игрок Иван угадал слово 'apple'! ===
Поздравляем! Вы угадали слово: apple
```

## Структура проекта

```
os_KP/
├── include/
│   ├── shared.h
│   └── game_logic.h
├── src/
│   ├── server.c
│   ├── client.c
│   └── game_logic.c
├── words.txt
└── Makefile
```

## Протокол

Сообщения передаются через именованные pipe'ы в формате `ТИП|параметр1|параметр2|...`

От клиента к серверу:
- `CONNECT|player_id|player_name` - подключение
- `GUESS|player_id|слово` - предположение
- `DISCONNECT|player_id` - отключение

От сервера к клиенту:
- `CONNECT|player_id|сообщение` - подтверждение подключения
- `RESULT|player_id|быки|коровы|сообщение` - результат предположения
- `WIN|player_id|слово|сообщение` - победа
- `GAME_STATE|сообщение` - состояние игры
- `DISCONNECT|player_id|сообщение` - отключение игрока

## Особенности

- Используется `select()` для мультиплексирования ввода
- Все pipe'ы открываются в неблокирующем режиме
- Игра продолжается при отключении игроков (пока есть хотя бы один активный)
- Автоматическая очистка pipe отключенных клиентов
- Простой текстовый протокол

## Ограничения

- Максимум 4 игрока
- Максимальная длина слова: 20 символов
- Максимальная длина имени: 50 символов
- Словарь загружается из `words.txt`, если файла нет - используется встроенный словарь из 10 слов

## Отладка

Сборка с отладкой:
```bash
make debug
```

При включенном DEBUG режиме логи пишутся в `server.log`.

## Команды клиента

- `/quit` или `/exit` - выход из игры
- `/help` - справка
